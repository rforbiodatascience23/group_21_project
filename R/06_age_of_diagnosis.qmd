---
title: "Distribution of the age of diagnosis"
format: html
editor: visual
---

### Libraries

```{r}
library("tidyverse")
```

### Distribution of the age of recieving a diagnosis

Type 1 diabetes is an autoimmune disease that has an onset in early life. We will now look at the distribution of the patients' ages when receiving their diagnosis.

For this analysis, only the patients with type 1 diabetes are included. Furthermore, only observations where the age is given as a specific number are included.

```{r}

#Loading the data and filtering it
data <- 
  read_tsv("./../data/04_aug_clean.tsv") |>
  filter(case_control == "Case") |>
  distinct(id, .keep_all = TRUE) |>
  select(age_diagnosis)


#Boxplot
data |>
  ggplot() +
  geom_boxplot(aes(x = age_diagnosis),
               size = 0.5, fill = "darkred") +
  labs(title = "Age of diagnosis, type 1 diabetes",
       subtitle = "Boxplot",
       x = "Age of diagnosis")


#Histogram
data |>
  ggplot() +
  geom_histogram(aes(x = age_diagnosis),
               size = 0.5, fill = "darkred",
               bins = 15) +
  labs(title = "Age of diagnosis",
       subtitle = "Histogram",
       x = "Age of diagnosis")
```

As it can be observed, more than 75% of the patients got the diagnosis between the ages of 10 and 15. This is interesting since the patients in the experiment were tested from an early age and until some of them were in their 20's. The size of the data used was only 29 observations, which means that the result of the analysis might be different from the actual pattern.

```{r}
p2 <-
  read_tsv("./../data/04_aug_clean.tsv") |>
  filter(case_control == "Case") |>
  distinct(id, .keep_all = TRUE) |>
  ggplot() +
  geom_histogram(aes(x = age_diagnosis),
               size = 0.5, fill = "darkred",
               bins = 15) +
  labs(title = "Age of diagnosis with type 1 diabetes",
       subtitle = "Boxplot",
       x = "Age of diagnosis")
```

```{r}
read_tsv("./../data/04_aug_clean.tsv") |>
  head(20)
```
