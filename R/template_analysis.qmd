---
title: "et_eller_andet"
format: html
editor: visual
---

## display data

```{r}
#| message: false
library("tidyverse")
library("viridis")
```

```{r}
#| warning: false
#| message: false
data <- read_tsv("./../data/04_aug_clean.tsv")

data |>
  group_by(case_control,age_visit,timepoint)|>
  summarize(total_temp_mu=mean(total_rearrangements)) |>
  ggplot(data=_,
         mapping=aes(x=age_visit,y=total_temp_mu))+
  geom_point(aes(color=timepoint))+
  labs(title="mean of total rearrangements pr. timepoint")+
  scale_color_viridis()+
  geom_smooth(method="lm",color="black")+
  facet_grid(~case_control)

data |>
  group_by(case_control,age_visit,timepoint)|>
  summarize(prod_temp_mu=mean(productive_rearrangements)) |>
  ggplot(data=_,
         mapping=aes(x=age_visit,y=prod_temp_mu))+
  geom_point(aes(color=timepoint))+
  labs(title="mean of productive rearrangements pr. timepoint")+
  scale_color_viridis()+
  geom_smooth(method="lm",color="black")+
  facet_grid(~case_control)


data |>
  group_by(case_control,age_visit,timepoint)|>
  summarize(frac_prod=mean(productive_rearrangements)/mean(total_rearrangements)) |>
  ggplot(data=_,
         mapping=aes(x=age_visit,y=frac_prod))+
  geom_point(aes(color=timepoint))+
  labs(title="fraction of productive rearrangements pr. timepoint")+
  scale_color_viridis()+
  geom_smooth(method="lm",color="black")+
  facet_grid(~case_control)
```

We see a slight rise in total and productive rearrangements for case patients and a slight decrease for control patients, when comparing the values against age at visit.

We see a steep rise in the fraction of productive rearrangement with age, which must mean that the differences in values between productive rearrangement and total rearrangement become smaller with age.

```{r}
#simpson clonality plot

data |> 
  ggplot(data=_,
         mapping=aes(x=age_visit,y=log(productive_simpson_clonality)))+
  geom_point(aes(color=timepoint))+
  labs(title="mean of total rearrangements pr. timepoint")+
  scale_color_viridis()+
  geom_smooth(method="lm",color="black")+
  facet_grid(~case_control)
```

Both case and control show a rise in productive simpson clonality, which shows the decrease of polyclonality in the individuals.
