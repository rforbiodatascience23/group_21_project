---
title: "08_expression_analysis"
format: html
editor: visual
---

## Load Libraries

```{r}
library(tidyverse)
```

## Load Data

```{r}
data <- read_tsv("./../data/04_aug_clean.tsv", show_col_types = FALSE)
```

## Data Analysis

```{r}
#| warning: false
# Gather the data for plotting
data_long <- data |>
  pivot_longer(cols = c(GAD65, ZnT8, IA_2, IAA),
               names_to = "antibody", 
               values_to = "expression") |>
  group_by(antibody, timepoint, case_control) |>
  summarise(mean_expression = mean(expression, na.rm = TRUE))

# Plotting for each antibody separately
plots <- data_long |>
  ggplot(aes(x = factor(timepoint), y = mean_expression, fill = case_control)) +
  geom_bar(stat = "identity",
           position = "dodge",
           alpha = 0.8,
           color = 'black') +
  facet_wrap(vars(antibody), scales = "free_y", nrow = 2) +
  labs(x = "Visit", y = "Mean Expression", fill = "Case/Control", title = "Antibody expression across the four visits stratified by case/control") +
  theme_minimal()

# Displaying the plots
plots
```
<<<<<<< HEAD

```{r}
#| warning: false
scatter_plots <- data_long %>%
  ggplot(aes(x = factor(timepoint), y = mean_expression, color = case_control)) +
  geom_point(position = position_jitter(width = 0.2), size = 2.5) +  # Adjust jitter and size as needed
  facet_wrap(~antibody, scales = "free_y", nrow = 2) +
  labs(x = "Visit", y = "Mean Expression", color = "Case/Control", title = "Antibody expression comparison between case and control across visits") +
  theme_minimal()

# Displaying the scatterplots
scatter_plots
```
=======
>>>>>>> 815cf9ee2aa6c99f1ea61a2b8932c083e0c18bc2
